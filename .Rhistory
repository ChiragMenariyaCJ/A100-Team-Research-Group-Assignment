# View the result
View(cr_long)
print(colnames(cr_long))
colnames(cr_long)[4] <- "Region_in_Jamaica"
colnames(cr_long)[3] <- "Number_of_Crashes"
colnames(cr_long)
summary(cr_long$Number_of_Crashes)
print(which.min(cr_long$Number_of_Crashes))
print(which.max(cr_long$Number_of_Crashes))
print (cr_long$Number_of_Crashes[64])
print (cr_long$Number_of_Crashes[1])
print (cr_long$Region_in_Jamaica[64])
print (cr_long$Region_in_Jamaica[1])
print (cr_long$City[64])
print (cr_long$City[1])
cr_test <- cr_long %>%
filter(Region %in% c("North", "South")) %>%
mutate(
Region = factor(Region, levels = c("South", "North"))
)
cr_test <- cr_long %>%
filter(Region %in% c("North", "South")) %>%
mutate(
Region = factor(Region, levels = c("South", "North"))
)
# Taking only North and South regions
cr_test <- cr_long %>%
filter(Region_in_Jamaica %in% c("North", "South")) %>%
mutate(
Region_in_Jamaica = factor(Region_in_Jamaica, levels = c("South", "North"))
)
# Taking only North and South regions
cr_test <- cr_long %>%
filter(Region_in_Jamaica %in% c("North", "South")) %>%
mutate(
Region_in_Jamaica = factor(Region_in_Jamaica, levels = c("South", "North"))
)
# Total Number of Crashes by Region in Jamaica
region_sum <- aggregate(Number_of_Crashes ~ Region_in_Jamaica, data = cr_long, sum, na.rm = TRUE)
# Create colors equal to number of regions in Jamaica
cols <- rainbow(nrow(region_sum))
# File Name for Exporting Bar Plot
png("Visualisation.png")
# Create bar plot with y-axis
hist(
cr_long$Number_of_Crashes,
main = "Histogram of Number of Crashes",
xlab = "Number of Crashes",
ylab = "Frequency",
col = "lightblue",
breaks = 10
)
# this closes the file after writing
dev.off()
# Wilcoxon test (non-normal data)
wilcox.test(Number_of_Crashes ~ Region_in_Jamaica, data = cr_test)
# Create bar plot with y-axis
hist(
cr_long$Number_of_Crashes,
main = "Histogram of Number of Crashes",
xlab = "Number of Crashes",
ylab = "Frequency",
col = "cols",
breaks = 10
)
hist(
cr_long$Number_of_Crashes,
main = "Histogram of Number of Crashes",
xlab = "Number of Crashes",
ylab = "Frequency",
col = cols,
breaks = 10
)
hist(
cr_long$Number_of_Crashes,
main = "Histogram of Number of Crashes",
xlab = "Number of Crashes",
ylab = "Frequency",
col = "lightblue",
breaks = 10
)
# To read the data
library(readr)
library(readxl)
# Import the dataset in "cr"
cr <- read_csv("Crashes By Place of Residence.csv", col_names = TRUE)
# Print Column Names
print(colnames(cr))
# To open the imported dataset and display it in a new tab.
View(cr)
# Install & Loading libraries to change format from wide to long
install.packages("tidyr")
install.packages("tidyr")
library(tidyr)
library(dplyr)
# Convert to long format
cr_long <- cr %>%
pivot_longer(
cols = -Date,
names_to = "City",
values_to = "Crashes"
) %>%
rename(Year = Date)
# Define regions
north_parishes <- c("St. James", "Trelawny", "St. Ann", "St. Mary", "Portland", "Hanover", "Westmoreland")
south_parishes <- c("Kingston", "St. Andrew", "St. Catherine", "Clarendon", "Manchester", "St. Elizabeth", "St. Thomas")
# Add Region column
cr_long <- cr_long %>%
mutate(
Region = case_when(
City %in% north_parishes ~ "North",
City %in% south_parishes ~ "South",
City == "Not known" ~ "Unknown",
City == "Overseas" ~ "External",
TRUE ~ "Other"
)
)
# View the result
View(cr_long)
# Export the long format data to a new CSV file
write.csv(cr_long, file = "output.csv", row.names = FALSE)
print(colnames(cr_long))
colnames(cr_long)[4] <- "Region_in_Jamaica"
colnames(cr_long)[3] <- "Number_of_Crashes"
# Analysis of Dataset
colnames(cr_long)
summary(cr_long$Number_of_Crashes)
print(which.min(cr_long$Number_of_Crashes))
print(which.max(cr_long$Number_of_Crashes))
print(cr_long$Number_of_Crashes[64])
print(cr_long$Number_of_Crashes[1])
print(cr_long$Region_in_Jamaica[64])
print(cr_long$Region_in_Jamaica[1])
print(cr_long$City[64])
print(cr_long$City[1])
# Taking only North and South regions
cr_test <- cr_long %>%
filter(Region_in_Jamaica %in% c("North", "South")) %>%
mutate(
Region_in_Jamaica = factor(Region_in_Jamaica, levels = c("South", "North"))
)
# File Name for Exporting Hist Plot
png("histogram_non_normal_data.png")
# Create Histogram
hist(
cr_long$Number_of_Crashes,
main = "Histogram of Number of Crashes",
xlab = "Number of Crashes",
ylab = "Frequency",
col = "lightblue",
breaks = 10
)
# this closes the file after writing
dev.off()
# Wilcoxon test (for not normally distributed data)
wilcox.test(Number_of_Crashes ~ Region_in_Jamaica, data = cr_test)
# File Name for Exporting Bar Plot
png("Visualisation.png")
# Total crashes by region
region_sum <- aggregate(Crashes ~ Region, data = cr_long, sum, na.rm = TRUE)
cr_long <- cr %>%
pivot_longer(
cols = -Date,
names_to = "City",
values_to = "Crashes"
) %>%
rename(Year = Date)
# Define regions
north_parishes <- c("St. James", "Trelawny", "St. Ann", "St. Mary", "Portland", "Hanover", "Westmoreland")
south_parishes <- c("Kingston", "St. Andrew", "St. Catherine", "Clarendon", "Manchester", "St. Elizabeth", "St. Thomas")
# Add Region column
cr_long <- cr_long %>%
mutate(
Region = case_when(
City %in% north_parishes ~ "North",
City %in% south_parishes ~ "South",
City == "Not known" ~ "Unknown",
City == "Overseas" ~ "External",
TRUE ~ "Other"
)
)
# View the result
View(cr_long)
# Export the long format data to a new CSV file
write.csv(cr_long, file = "output.csv", row.names = FALSE)
print(colnames(cr_long))
colnames(cr_long)[4] <- "Region_in_Jamaica"
colnames(cr_long)[3] <- "Number_of_Crashes"
# Analysis of Dataset
colnames(cr_long)
summary(cr_long$Number_of_Crashes)
print(which.min(cr_long$Number_of_Crashes))
print(which.max(cr_long$Number_of_Crashes))
print(cr_long$Number_of_Crashes[64])
print(cr_long$Number_of_Crashes[1])
print(cr_long$Region_in_Jamaica[64])
print(cr_long$Region_in_Jamaica[1])
print(cr_long$City[64])
print(cr_long$City[1])
# Taking only North and South regions
cr_test <- cr_long %>%
filter(Region_in_Jamaica %in% c("North", "South")) %>%
mutate(
Region_in_Jamaica = factor(Region_in_Jamaica, levels = c("South", "North"))
)
# File Name for Exporting Hist Plot
png("histogram_non_normal_data.png")
# Create Histogram
hist(
cr_long$Number_of_Crashes,
main = "Histogram of Number of Crashes",
xlab = "Number of Crashes",
ylab = "Frequency",
col = "lightblue",
breaks = 10
)
# this closes the file after writing
dev.off()
# Wilcoxon test (for not normally distributed data)
wilcox.test(Number_of_Crashes ~ Region_in_Jamaica, data = cr_test)
# File Name for Exporting Bar Plot
png("Visualisation.png")
# Total crashes by region
region_sum <- aggregate(Number_of_Crashes ~ Region_in_Jamaica, data = cr_long, sum, na.rm = TRUE)
# Create colors equal to number of regions
cols <- rainbow(nrow(region_sum))
# Create bar plot with y-axis
bp <- barplot(
region_sum$Number_of_Crashes,
names.arg = rep("", nrow(region_sum)),
col = rainbow(nrow(region_sum)),
main = "Distribution of Number of Crashes by Region in Jamaica",
xlab = "Region",
ylab = "Number of Crashes",
ylim = c(0, max(region_sum$Crashes) * 1.15)
)
cr_long <- cr %>%
pivot_longer(
cols = -Date,
names_to = "City",
values_to = "Crashes"
) %>%
rename(Year = Date)
# Define regions
north_parishes <- c("St. James", "Trelawny", "St. Ann", "St. Mary", "Portland", "Hanover", "Westmoreland")
south_parishes <- c("Kingston", "St. Andrew", "St. Catherine", "Clarendon", "Manchester", "St. Elizabeth", "St. Thomas")
# Add Region column
cr_long <- cr_long %>%
mutate(
Region = case_when(
City %in% north_parishes ~ "North",
City %in% south_parishes ~ "South",
City == "Not known" ~ "Unknown",
City == "Overseas" ~ "External",
TRUE ~ "Other"
)
)
# View the result
View(cr_long)
# Export the long format data to a new CSV file
write.csv(cr_long, file = "output.csv", row.names = FALSE)
print(colnames(cr_long))
colnames(cr_long)[4] <- "Region_in_Jamaica"
colnames(cr_long)[3] <- "Number_of_Crashes"
# Analysis of Dataset
colnames(cr_long)
summary(cr_long$Number_of_Crashes)
print(which.min(cr_long$Number_of_Crashes))
print(which.max(cr_long$Number_of_Crashes))
print(cr_long$Number_of_Crashes[64])
print(cr_long$Number_of_Crashes[1])
print(cr_long$Region_in_Jamaica[64])
print(cr_long$Region_in_Jamaica[1])
print(cr_long$City[64])
print(cr_long$City[1])
# Taking only North and South regions
cr_test <- cr_long %>%
filter(Region_in_Jamaica %in% c("North", "South")) %>%
mutate(
Region_in_Jamaica = factor(Region_in_Jamaica, levels = c("South", "North"))
)
# File Name for Exporting Hist Plot
png("histogram_non_normal_data.png")
# Create Histogram
hist(
cr_long$Number_of_Crashes,
main = "Histogram of Number of Crashes",
xlab = "Number of Crashes",
ylab = "Frequency",
col = "lightblue",
breaks = 10
)
# this closes the file after writing
dev.off()
# Wilcoxon test (for not normally distributed data)
wilcox.test(Number_of_Crashes ~ Region_in_Jamaica, data = cr_test)
# File Name for Exporting Bar Plot
png("Visualisation.png")
# Total Number of Crashes by Region in Jamaica
region_sum <- aggregate(Number_of_Crashes ~ Region_in_Jamaica, data = cr_long, sum, na.rm = TRUE)
# Create colors equal to number of regions
cols <- rainbow(nrow(region_sum))
# Create bar plot with y-axis
bp <- barplot(
region_sum$Number_of_Crashes,
names.arg = rep("", nrow(region_sum)),
col = rainbow(nrow(region_sum)),
main = "Distribution of Number of Crashes by Region in Jamaica",
xlab = "Region",
ylab = "Number of Crashes",
ylim = c(0, max(region_sum$Number_of_Crashes) * 1.15)
)
# Add values on bars
text(
x = bp,
y = region_sum$Number_of_Crashes,
labels = format(region_sum$Number_of_Crashes, big.mark = ","),
pos = 3,
cex = 0.8
)
# Legend
legend(
"topright",
legend = region_sum$Region_in_Jamaica,
fill = rainbow(nrow(region_sum)),
bty = "o",
bg = "white",
box.col = "black"
)
# this closes the file after writing
dev.off()
# Wilcoxon test (for not normally distributed data)
wilcox.test(Number_of_Crashes ~ Region_in_Jamaica, data = cr_test)
# Total Number of Crashes by Region in Jamaica
region_sum <- aggregate(Number_of_Crashes ~ Region_in_Jamaica, data = cr_long, sum, na.rm = TRUE)
# Create colors equal to number of regions
cols <- rainbow(nrow(region_sum))
# Create bar plot with y-axis
bp <- barplot(
region_sum$Number_of_Crashes,
names.arg = rep("", nrow(region_sum)),
col = rainbow(nrow(region_sum)),
main = "Distribution of Number of Crashes by Region in Jamaica",
xlab = "Region",
ylab = "Number of Crashes",
ylim = c(0, max(region_sum$Number_of_Crashes) * 1.15)
)
# Add values on bars
text(
x = bp,
y = region_sum$Number_of_Crashes,
labels = format(region_sum$Number_of_Crashes, big.mark = ","),
pos = 3,
cex = 0.8
)
# Legend
legend(
"topright",
legend = region_sum$Region_in_Jamaica,
fill = rainbow(nrow(region_sum)),
bty = "o",
bg = "white",
box.col = "black"
)
View(cr_long)
contingency_table <- cr_long %>%
group_by(Year, Region_in_Jamaica) %>%
summarise(Total_Crashes = sum(Number_of_Crashes), .groups = "drop")
print(contingency_table)
# Pivot to wide format to match a classic contingency table
contingency_table_wide <- contingency_table %>%
pivot_wider(
names_from = Region_in_Jamaica,
values_from = Total_Crashes,
values_fill = 0
)
print(contingency_table_wide)
total_row <- contingency_table_wide %>%
summarise(
Year = "TOTAL",
South = sum(South, na.rm = TRUE),
North = sum(North, na.rm = TRUE),
Unknown = sum(Unknown, na.rm = TRUE),
External = sum(External, na.rm = TRUE)
)
print(contingency_table_wide)
print(contingency_table_wide_with_total)
contingency_table_wide_with_total <- contingency_table_wide %>%
summarise(
Year = "TOTAL",
South = sum(South, na.rm = TRUE),
North = sum(North, na.rm = TRUE),
Unknown = sum(Unknown, na.rm = TRUE),
External = sum(External, na.rm = TRUE)
)
print(contingency_table_wide_with_total)
View(contingency_table_wide_with_total)
contingency_table <- cr_long %>%
group_by(Year, Region_in_Jamaica) %>%
summarise(Total_Crashes = sum(Number_of_Crashes), .groups = "drop")
print(contingency_table)
# Pivot to wide format to match a classic contingency table
contingency_table_wide <- contingency_table %>%
pivot_wider(
names_from = Region_in_Jamaica,
values_from = Total_Crashes,
values_fill = 0
)
print(contingency_table_wide)
total_row <- contingency_table_wide %>%
summarise(
Year = "TOTAL",
South = sum(South, na.rm = TRUE),
North = sum(North, na.rm = TRUE),
Unknown = sum(Unknown, na.rm = TRUE),
External = sum(External, na.rm = TRUE)
)
contingency_table_final <- bind_rows(contingency_table_wide, total_row)
contingency_table_wide$Year <- as.character(contingency_table_wide$Year)
print(contingency_table_wide)
total_row <- contingency_table_wide %>%
summarise(
Year = "TOTAL",
South = sum(South, na.rm = TRUE),
North = sum(North, na.rm = TRUE),
Unknown = sum(Unknown, na.rm = TRUE),
External = sum(External, na.rm = TRUE)
)
contingency_table_final <- bind_rows(contingency_table_wide, total_row)
print(contingency_table_wide_with_total)
contingency_table <- cr_long %>%
group_by(Year, Region_in_Jamaica) %>%
summarise(Total_Crashes = sum(Number_of_Crashes), .groups = "drop")
print(contingency_table)
# Pivot to wide format to match a classic contingency table
contingency_table_wide <- contingency_table %>%
pivot_wider(
names_from = Region_in_Jamaica,
values_from = Total_Crashes,
values_fill = 0
)
contingency_table_wide$Year <- as.character(contingency_table_wide$Year)
print(contingency_table_wide)
total_row <- contingency_table_wide %>%
summarise(
Year = "TOTAL",
South = sum(South, na.rm = TRUE),
North = sum(North, na.rm = TRUE),
Unknown = sum(Unknown, na.rm = TRUE),
External = sum(External, na.rm = TRUE)
)
contingency_table_final <- bind_rows(contingency_table_wide, total_row)
print(contingency_table_wide_with_total)
print(contingency_table_final)
# Saving the table as .CSV file
write.csv(contingency_table_final, "csv_files/Contingency Table.csv", row.names = FALSE)
# Saving the table as .CSV file
write.csv(contingency_table_final, "exported_csv_files/Contingency Table.csv", row.names = FALSE)
# Saving the table as .CSV file but Create a folder first named "exported_csv_files"
write.csv(contingency_table_final, "exported_csv_files/Contingency Table.csv", row.names = FALSE)
write.csv(cr_long, file = "long_format.csv", row.names = FALSE)
write.csv(cr_long, file = "exported_csv_files/long_format.csv", row.names = FALSE)
write.csv(cr_long, file = "Exported CSV Files/Long Formated.csv", row.names = FALSE)
write.csv(cr_long, file = "Exported CSV Files/Long Formated.csv", row.names = FALSE)
write.csv(contingency_table_final, "Exported CSV Files/Contingency Table.csv", row.names = FALSE)
png("Images/Histogram for distribution.png")
# Creating Histogram for to check data is normal or abnormal distributed data
hist(
cr_long$Number_of_Crashes,
main = "Histogram of Number of Crashes",
xlab = "Number of Crashes",
ylab = "Frequency",
col = "lightblue",
breaks = 10
)
# this closes the file after writing
dev.off()
# File Name for Exporting Bar Plot
png("Images/Visualisation.png")
# Total Number of Crashes by Region in Jamaica
region_sum <- aggregate(Number_of_Crashes ~ Region_in_Jamaica, data = cr_long, sum, na.rm = TRUE)
# Create colors equal to number of regions
cols <- rainbow(nrow(region_sum))
# Create bar plot with y-axis
bp <- barplot(
region_sum$Number_of_Crashes,
names.arg = rep("", nrow(region_sum)),
col = rainbow(nrow(region_sum)),
main = "Distribution of Number of Crashes by Region in Jamaica",
xlab = "Region",
ylab = "Number of Crashes",
ylim = c(0, max(region_sum$Number_of_Crashes) * 1.15)
)
# Add values on bars
text(
x = bp,
y = region_sum$Number_of_Crashes,
labels = format(region_sum$Number_of_Crashes, big.mark = ","),
pos = 3,
cex = 0.8
)
# Legend
legend(
"topright",
legend = region_sum$Region_in_Jamaica,
fill = rainbow(nrow(region_sum)),
bty = "o",
bg = "white",
box.col = "black"
)
# this closes the file after writing
dev.off()
